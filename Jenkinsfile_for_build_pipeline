//Define needed parameters

properties([
  parameters([
                    // Parameters used for Building Stage of Package
   string(defaultValue: 'https://github.com/hluci93/maven-web-application', description: 'GitHub Repository used for importing configuration.', name: 'git_repo'),
   gitParameter(branch: '', branchFilter: 'origin/(.*)', defaultValue: 'master', description: '', name: 'git_repo_branch', quickFilterEnabled: false, selectedValue: 'NONE', sortMode: 'NONE', tagFilter: '*', type: 'PT_BRANCH')
                            
  ])
])


//START PIPELINE
pipeline {
  agent {
    node{
      label 'mvn'
    }
  }
    
    tools {
        // Will Use maven version 3.8.5 defined with the same name.
        maven "3.8.5"
    }
    
    options{
    timestamps()
    buildDiscarder(logRotator(artifactDaysToKeepStr: '', artifactNumToKeepStr: '', daysToKeepStr: '2', numToKeepStr: '5'))
    }

stages {
  stage("Get Git Code")
        {
            steps 
                {
                // Get code from GitHub repository
                git branch: "${params.git_repo_branch}", credentialsId: 'c9d8cdef-1edb-4e31-9682-ed6d205f722b', url: "${params.git_repo}"
                }
        } 
  stage("Build Package")
        {
                 steps
                 {
                 echo 'Building package'
                 sh 'mvn package'
                 }
              }
      }//Stages Closing
}//Pipeline closing


